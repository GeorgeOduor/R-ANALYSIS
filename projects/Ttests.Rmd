---
title: " T-TESTs IN R"
author: "George"
date: "August 5, 2018"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# ONE SAMPLE T TEST
One sample t test is a statistical test used to compare a sample mean with a hypothesised or theoritical mean.
```{r}
library(dplyr)
library(tidyverse)
library(broom)
library(ggplot2)
```

##The hypothesis

$H_O:\mu=\bar x$ Sample mean is equal to the hypothesised mean.  
$H_O:\mu \ne \bar x$ Sample mean is not equal hypothesised mean.  

where $\mu$ is the sample mean and $\bar x$ is our hypothesised mean.

##The statistic.

$$t=\frac{(\mu-\bar x)}{\frac{s^2}{n}} $$ 
##Performing in R

To peform this test in R we will need this syntax,

```{r}
#t.test(x,mu=0,alternative="two.sided")
```

###Sample project.

A manufacturer of high-performance automobiles produces disc brakes that must measure 322 millimeters in diameter. Quality control randomly draws 16 discs made by each of eight production machines and measures their diameters.  

In this example our hypothetical mean is 322mm. 

###Hypothesis

**Null hypothesis**:*Population mean equals to 322mm*  
**Alternative Hypothesis**:*Population mean is significantly different from 322mm*

##The test.

I am going to import our data first into R session.To do this i will first load the `foreign()` package which will alow me to import SPSS data file.
```{r}
library(foreign)
mydata=read.spss("C:/Users/Ruralnet20/Desktop/Statistics/20/Samples/English/brakes.sav",to.data.frame = TRUE,use.value.labels = TRUE)

glimpse(mydata)
```
Before the test i will take a view into my data and see its dimensions, variable names and some of its properties using the glimpse() command in dplyr package.I will 
also need to transform the first variable into factor in order to perform my one sample t-test per group using the mutate comand.


```{r}
head(mutate(mydata,machines=as.factor(machine)))
mydata1=mydata %>% mutate(machines=as.factor(machine))%>% #to transform the data
  select(machines,brake) #to select only the required variables for analysis
```
###Visualization.

Data visualization is an important part of data analysis.I will make a boxplot of the brakes by the machines in the data set.

```{r}
ggplot(mydata1,mapping = aes(x=machines,y=brake))+geom_boxplot(fill="gold1",color="goldenrod2",alpha=.9,outlier.color = "red",outlier.shape = 20)+labs(title="BOX PLOT OF BRAKES BY MACHINES",y="Brakes",x="Machine number")+theme(title=element_text(size = 12,hjust = .5))+theme_bw()
```
To perform this test i will:
```{r}
mydata1 %>% summarise(ttest=list(tidy(t.test(brake,mu=322)))) %>% unnest()
```

##Interpretation

Looking at the above output we can safely conclude that at 95% CI the average diamerter of the wheels produced by all machines is significantly different from the stipulated diamete of 322.The probability of obtaining our sample results when the null hypothesis is true is at p=0.0376.
###Within Group tests
Since my data is grouped by brakes,it will be important to carry out this test within the groups.This will enable us to scrutinize the machines.


```{r}
mydata1 %>% group_by(machines) %>% summarise(results=list(tidy(t.test(brake,mu=322)))) %>% unnest()
```

From the output above we can see thatbrakes produced by machines 2,4 and 7 were significantly different from the hypothesised mean of 322mm with p<0.05.




##TWO SAMPLE T-TEST

Two sample t test ,also known as independent samples t test is used to determine if there is a significant difference between two independent groups.The observations made on the sample members must all be independent of each other. So, for example, individuals from one population must not be individually matched with those from the other population, nor should the individuals within each group be related to each other.

The variable to be compared is assumed to have a normal distribution with the same standard deviation in both populations.


##The test statistic

$$t=\frac{\bar y_1-\bar y_2}{s\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}}$$
where:
where$\bar y_1$ and $\bar y_2$ are the means in groups 1 and 2,n1 and n2 are the sample sizes, and s is the pooled standard deviation.

###The hypotheses.

$H_0$:$\mu_1=\mu_2$  
$H_0$:$\mu_1\ne\mu_2$

##The test in R
I am going to work with water samples data frame from SPSS.

This data contains water samples collected in two different geographical areas in Kisumu area.My main aim is to determine the if the ph difference between the two areas were significant.

Apart from Location of collection this data is grouped into  different exact points of collections namely household and kiosks.

For analytical purposes and answering the research questions i am going to carry out an independent test to determine if a significant difference exists between all the two regions and then proceed futher and split my data by exact point of collectin.This will test for the difference within the groups.

Lets dig in
```{r}
water=read.spss("C:/Users/Ruralnet20/Desktop/Guide/STATISTICALTEST/water.sav",to.data.frame = TRUE,use.value.labels = TRUE)#for reading my data into R

x=filter(water,LOCATION == "Nyalenda") %>% select(PH)#To get the column for ph in nyalenda ea aronly
y=filter(water,LOCATION == "Manyatta") %>% select(PH)#To get the column for ph in Manyatta area only
water %>% summarise( res=list(tidy(t.test(x,y)))) %>% unnest()#The t.test

```

###Interpretation of the results

The above results clearly indicate that there is no significat difference between ph mean in Nyalenda and Manyatta,p>o.o5,more confirmed by the confidence iterval.

###Narrowing into the groups.
```{r}
water %>% group_by(POINT) %>% summarise( res=list(tidy(t.test(x,y)))) %>% unnest()#The t.test
```

###PAIRED SAMPLE T TEST

The paired sample t test is used to test if there is a significant difference before or after a an intervention.


###The statistic

$$t=\frac{\bar d}{s_d\sqrt{n}}$$

##Sample problem

A physician is evaluating a new diet for her patients with a family history of heart disease. To test the effectiveness of this diet, 16 patients are placed on the diet for 6 months. Their weights and triglyceride levels are measured before and after the study, and the physician wants to know if either set of measurements has changed.

I am going to use Paired-Samples T Test to determine whether there is a statistically significant difference between the pre- and post-diet weights and **triglyceride** levels of these patients.

```{r}
dietstudy=foreign::read.spss("C:/Users/Ruralnet20/Desktop/Statistics/20/Samples/English/dietstudy.sav",use.value.labels = TRUE,to.data.frame = TRUE)
glimpse(dietstudy)

dietstudy %>% 
  select(tg0,tg4,) %>% #head
  summarise(res=list(tidy(t.test(tg0,tg4,paired = TRUE)))) %>% unnest()
```


The results above shows clearly that the difference is not statisticaly significant at p>0.05.This can indicate that the new diet has no effect in Trglyceride levels

###FINALY
This was a simple one ilustration of how to carry out simple statistics tests in R.
Thanks for reading along.








